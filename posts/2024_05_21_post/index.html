<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Claire-Cécile Juhasz">
<meta name="dcterms.date" content="2024-05-21">
<meta name="description" content="École printemps Calcul Québec - Bases de bash et grappes de calcul">

<title>QUARTO_grimmoire_job - Bash, grappes de calcul, analyse et visualisation en Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">QUARTO_grimmoire_job</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../code/code_langage.html" rel="" target="">
 <span class="menu-text">Aide-mémoire langages</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html" rel="" target="">
 <span class="menu-text">Job Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Bash, grappes de calcul, analyse et visualisation en Python</h1>
                  <div>
        <div class="description">
          École printemps Calcul Québec - Bases de bash et grappes de calcul
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">formation</div>
                <div class="quarto-category">école été</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Claire-Cécile Juhasz </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 21, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#école-dété---analyses-et-visualisation-en-python" id="toc-école-dété---analyses-et-visualisation-en-python" class="nav-link active" data-scroll-target="#école-dété---analyses-et-visualisation-en-python">École d’été - Analyses et visualisation en Python</a>
  <ul class="collapse">
  <li><a href="#mardi-21-mai-2024" id="toc-mardi-21-mai-2024" class="nav-link" data-scroll-target="#mardi-21-mai-2024">Mardi 21 mai 2024</a>
  <ul class="collapse">
  <li><a href="#formation-1---daniel---the-unix-shell" id="toc-formation-1---daniel---the-unix-shell" class="nav-link" data-scroll-target="#formation-1---daniel---the-unix-shell">Formation 1 - Daniel - The Unix shell</a></li>
  <li><a href="#formation-2---hélène-gingras---premiers-pas-sur-les-grappes-de-calcul" id="toc-formation-2---hélène-gingras---premiers-pas-sur-les-grappes-de-calcul" class="nav-link" data-scroll-target="#formation-2---hélène-gingras---premiers-pas-sur-les-grappes-de-calcul">Formation 2 - Hélène Gingras - Premiers pas sur les grappes de calcul</a></li>
  </ul></li>
  <li><a href="#mercredi-22-mai-2024" id="toc-mercredi-22-mai-2024" class="nav-link" data-scroll-target="#mercredi-22-mai-2024">Mercredi 22 mai 2024</a>
  <ul class="collapse">
  <li><a href="#formation-1---caroline-baril---introduction-à-la-gestion-de-données-de-recherche-gdr" id="toc-formation-1---caroline-baril---introduction-à-la-gestion-de-données-de-recherche-gdr" class="nav-link" data-scroll-target="#formation-1---caroline-baril---introduction-à-la-gestion-de-données-de-recherche-gdr">Formation 1 - Caroline Baril - Introduction à la gestion de données de recherche (GDR)</a></li>
  <li><a href="#formation-2---lina-harper---nettoyage-des-données-avec-openrefine" id="toc-formation-2---lina-harper---nettoyage-des-données-avec-openrefine" class="nav-link" data-scroll-target="#formation-2---lina-harper---nettoyage-des-données-avec-openrefine">Formation 2 - Lina Harper - Nettoyage des données avec OpenRefine</a></li>
  </ul></li>
  <li><a href="#jeudi-23-mai-2024" id="toc-jeudi-23-mai-2024" class="nav-link" data-scroll-target="#jeudi-23-mai-2024">Jeudi 23 mai 2024</a>
  <ul class="collapse">
  <li><a href="#formation-1---charles---introduction-à-python" id="toc-formation-1---charles---introduction-à-python" class="nav-link" data-scroll-target="#formation-1---charles---introduction-à-python">Formation 1 - Charles - Introduction à Python</a></li>
  </ul></li>
  <li><a href="#vendredi-24-mai-2024" id="toc-vendredi-24-mai-2024" class="nav-link" data-scroll-target="#vendredi-24-mai-2024">Vendredi 24 mai 2024</a>
  <ul class="collapse">
  <li><a href="#analyses-et-visualisation---pier-luc-st-onge-analyste" id="toc-analyses-et-visualisation---pier-luc-st-onge-analyste" class="nav-link" data-scroll-target="#analyses-et-visualisation---pier-luc-st-onge-analyste">Analyses et Visualisation - Pier-Luc St-Onge (analyste)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="école-dété---analyses-et-visualisation-en-python" class="level1">
<h1>École d’été - Analyses et visualisation en Python</h1>
<section id="mardi-21-mai-2024" class="level2">
<h2 class="anchored" data-anchor-id="mardi-21-mai-2024">Mardi 21 mai 2024</h2>
<p><img src="https://jupyter.org/assets/logos/rectanglelogo-greytext-orangebody-greymoons.svg" class="img-fluid"></p>
<ul>
<li>création compte sur <a href="https://jupyter.a-ecole.calculquebec.cloud/hub/login">Jupyterhub</a> (voir projet <a href="https://jupyter.org/">Jupyter</a> &amp; <a href="https://docs.jupyter.org/en/latest/">documentation</a> about Jupyter) - JupyterLab permet la création d’un notebook (comme rmarkdown)</li>
<li>présentation &amp; mot de bienvenue par Charles - Canal Slack #analyse-de-données</li>
</ul>
<section id="formation-1---daniel---the-unix-shell" class="level3">
<h3 class="anchored" data-anchor-id="formation-1---daniel---the-unix-shell">Formation 1 - Daniel - The Unix shell</h3>
<p><a href="https://swcarpentry.github.io/shell-novice/">Carpentry formation</a></p>
<p>Exercices dans JupyterHub<br>
cheat sheet interactive pour les commandes bash –&gt; <a href="https://tldr.sh/">tldr pages</a> ou <a href="https://devhints.io/bash">devhints</a> mais on peut aussi utiliser <code>command --help</code> ou <code>man command</code></p>
<p>prompt = invite de commande - donne le nom de usager et le nom de la machine (ici <code>nodex</code>)<br>
shell = faite pour entourée le noyau de l’ordinateur et le protéger. On ne communique pas diretement avec le noyau, mais on passe par le shell<br>
Il existe plusieurs formes de shells pour Unix (cornshell, zshell, cshell, zshrc, …), mais bash étant le plus répandu. The bash shell is written in C.</p>
<p>Liste de commandes à connaître:</p>
<p>Structure classique d’une commande <code>command -options argument</code><br>
<img src="https://swcarpentry.github.io/shell-novice/fig/shell_command_syntax.svg" class="img-fluid"></p>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 35%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>command</th>
<th>function</th>
<th>remarq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pwd</code></td>
<td>affiche le répertoire dans lequel on se trouve actuellement</td>
<td>premier slash <code>/</code> correspd à la racine d’où partent tous les répertoires - pwd for <u>path working directory </u></td>
</tr>
<tr class="even">
<td><code>ctl + l</code> or <code>clear</code></td>
<td>nettoyer l’écran</td>
<td></td>
</tr>
<tr class="odd">
<td><code>ls -F</code></td>
<td>affiche le contenu du repo dans lequel on se trouve</td>
<td>for list - <code>-F</code> pour discerner repo &amp; files, <code>-h</code> montre la taille des fichiers lisibles par l’humain, <code>-l</code> for long list (contient plus d’informations), <code>-t</code> tri par date, <code>-S</code> tri par taille de fichier</td>
</tr>
<tr class="even">
<td><code>cd</code></td>
<td>navigation dans un autre repo</td>
<td>for change directory, commande <strong>relative</strong> au répertoire actuelle, utiliser <code>cd ..</code> pour revenir un niveau au dessus de là où je me trouve, <code>cd sans argument</code> fait repartir dans le répertoire personnel <code>/home/user/</code>, <code>cd</code> peut aussi être utilisé avec un absolute path, <code>cd ~/project/</code> avec le tild qui permet de référer au repo personnel et <code>cd .</code> correspond au répertoire actuel, <code>cd /</code> dirige vers la racine de tous les fichiers</td>
</tr>
<tr class="odd">
<td><code>TAB completion</code></td>
<td>pour compléter à partir de la/les premières lettres des fichiers/dossiers présents dans le repo</td>
<td></td>
</tr>
<tr class="even">
<td><code>mkdir folderName</code></td>
<td>création d’un répertoire</td>
<td>for make directory - éeviter les espaces dans les noms de files and folders (sinon création de deux fichiers ou repo), pas d’accents non plus ou caractères spéciaux</td>
</tr>
<tr class="odd">
<td><code>rm -r</code></td>
<td>effece un fichier/dossier</td>
<td><code>-r</code> is for recurssive (pour les dossiers) ce qui permet de descendre dans le repo, effacer tous les fichiers puis effacer le dossier parent, <code>-f</code> pour forcer l’effacement, <code>-i</code> pour demander (interroger) si on est sûr de remove</td>
</tr>
<tr class="even">
<td><code>nano</code> ou <code>touch</code></td>
<td>création d’un fichier</td>
<td>équivalent d’éditeur de texte, plus efficace à utiliser sont <code>vim</code> ou <code>emacs</code> si on utilise beaucoup le shell, avec <code>touch</code> créé un fichier complètement vide utilisé pour des logiciels qui ont besoin d’un fichier déjà existant pour écrire les résultats</td>
</tr>
<tr class="odd">
<td><code>which</code></td>
<td>localise les fichiers binaires</td>
<td></td>
</tr>
<tr class="even">
<td><code>mv lastNAme.txt newName.txt</code></td>
<td>renomme un fichier ou déplace un fichier</td>
<td>for move si on ajoute un absolute path dans la deuxième partie de commande ex: <code>mv new_work.txt ~/</code></td>
</tr>
<tr class="odd">
<td><code>cp source cible</code></td>
<td>copie un fichier</td>
<td>possible de donner un nouveau nom au fichier copier et de le changer de repo, utiliser <code>-r</code> si la source est un repo, la <code>source</code> peut être multiple, l’essentiel étant que le dernier dossier soit la <code>cible</code></td>
</tr>
<tr class="even">
<td><code>&amp;&amp;</code></td>
<td>sépare deux commandes que l’on souhaite excécuter successivement</td>
<td>s’excecute sous condition que la première fonctionne, <code>;</code> peut aussi être utilisé à la place du double esperluette <code>&amp;&amp;</code></td>
</tr>
<tr class="odd">
<td><code>*</code></td>
<td>wildcart (caractère générique) permettant un pattern matching</td>
<td>peu importe le nombre de caractère</td>
</tr>
<tr class="even">
<td><code>?</code></td>
<td>remplace un seul caractère</td>
<td></td>
</tr>
<tr class="odd">
<td><code>cat</code></td>
<td>voir le contenu d’un fichier texte</td>
<td></td>
</tr>
<tr class="even">
<td><code>wc</code></td>
<td>affiche nb lignes, nb mots et nb caractères</td>
<td>for word count, ex: <code>wc *.txt</code> applique la commande sur tous les fichiers txt et fait la somme, <code>-l</code> donne uniquement le nombre de lignes</td>
</tr>
<tr class="odd">
<td><code>&gt; fileName</code></td>
<td>redire la sortie de commande vers un fichier</td>
<td></td>
</tr>
<tr class="even">
<td><code>^c</code></td>
<td>pour annuler</td>
<td></td>
</tr>
<tr class="odd">
<td><code>sort</code></td>
<td>tri sur la prmière colonne d’un fichier</td>
<td><code>-n</code> pour numérique, <code>-k</code> qui permet de choisir sur quelle colonne triée</td>
</tr>
<tr class="even">
<td><code>head</code></td>
<td>récupère les premières lignes d’un fichier</td>
<td><code>-n</code> permet de spécifier le nombre de ligne que l’on souhaite extraire</td>
</tr>
<tr class="odd">
<td><code>\|</code></td>
<td>pipe</td>
<td>dans une succession de commande, permet d’utiliser la sortie de la première commande pour excécuter la deuxième et ainsi de suite</td>
</tr>
</tbody>
</table>
<p><u>Exemple du pipe - Représente la puissance de l’utilisation du unix shell</u><br>
<img src="https://swcarpentry.github.io/shell-novice/fig/redirects-and-pipes.svg" class="img-fluid"></p>
<p>==&gt; parcourir la suite de la formation de Carpentry</p>
</section>
<section id="formation-2---hélène-gingras---premiers-pas-sur-les-grappes-de-calcul" class="level3">
<h3 class="anchored" data-anchor-id="formation-2---hélène-gingras---premiers-pas-sur-les-grappes-de-calcul">Formation 2 - Hélène Gingras - Premiers pas sur les grappes de calcul</h3>
<p><img src="https://www.calculquebec.ca/wp-content/uploads/2021/11/Narvalcouleurlogocq.png" class="img-fluid"></p>
<p>CIP = Calcul informatique de pointe tt calcul qui fait utilisation intensive de ress. info. ou qui est limité par la ressource dispo (ex. CPU, GPU, mémoire, stockage,&nbsp;temps)</p>
<p>Obj. calcul Qc = Fournir au milieu universitR des envir, informatiq et des expertises pour la recherche</p>
<p><strong>Monarque</strong> = ordinateur quantique</p>
<p>À disponibilité: grappes de calcul, espace info-nuagiques (hébergement de site internet par exemple) et stockage de data<br>
Voir la <a href="https://docs.alliancecan.ca/wiki/Technical_documentation">documentation</a><br>
Voir les notebooks pour de la formation <a href="https://alliancecan.ca/fr">Alliance de recherche numérique</a> chapote à l’échelle nationale (grand coordonnateur) <img src="https://alliancecan.ca/themes/custom/site_theme/images/alliance_logo_french-first.svg" class="img-fluid"></p>
<p><a href="https://www.calculquebec.ca/">Calcul Québec</a> est une antenne de l’alliance.</p>
<p>Quelle grappe choisir ?</p>
<ul>
<li>celle déjà utilisée par le labo</li>
<li>celle physiquement présente au plus proche (béluga, narval)</li>
<li>celle qui correspond à nos besoins (gna)</li>
</ul>
<p>Pour la suite, cf la <a href="https://drive.google.com/drive/folders/17rGmHm-AeM1WnkczDVTd12CZnAprddU4">présentation</a><br>
Première étape après la connexion SSH, arrivé sur un noeud de connexion qui donne accès aux noeuds de calcul. Le noeud de login (qui peut être utilisé pour la session interactive) a accès à internet mais pas les noeuds de calcul. À partir du noeud de login, accès aux différents dossiers, chargement des fichiers nécessaires. Sur les grappes, sauvegarde automatique pour les espaces home (donc si fausse manip avec <code>rm</code>, moyen de les récupérer). Sur le noeud de connexion, possible d’utiliser <code>git (clone)</code> via <code>git-lfs</code> pour large file system qui permet d’associer et stocker des jeux de données à un répertoire git (outil complémentaire qui peut être utiliser dans le souci de reproductibilité et transparence). Pour aller chercher les données en ligne: <code>wget</code>, <code>curl</code>, <code>python</code>, <code>git-lfs</code>.</p>
<section id="les-modules-pour-créer-son-environnement" class="level4">
<h4 class="anchored" data-anchor-id="les-modules-pour-créer-son-environnement"><u>Les modules</u> pour créer son environnement</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> spider <span class="op">&lt;</span>mot clé<span class="op">&gt;</span>  # recherche par mot clé</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> avail <span class="pp">[</span><span class="ss">module</span><span class="pp">]</span>    <span class="co"># disponible</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load <span class="op">&lt;</span>module<span class="op">&gt;</span>     # charger un module</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> unload <span class="op">&lt;</span>module<span class="op">&gt;</span>   # décharger un module</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> list              <span class="co"># afficher les modules activés</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> purge             <span class="co"># Revenir à l’état d’origine</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>💥 ATTENTION ! Ne pas utiliser <code>conda</code> (problématique pour les grappes)</p>
<p>💡 En utilisant <code>module spider r/4.4.0</code>, permet de voir quelles dépendances sont nécessaires.<br>
💡 Bonne pratique: toujours préciser la version des modules que l’on charge.<br>
💡 <code>module spider nom_paquet</code> fait du fuzzy matching et va sortir la liste des modules qui contiennent le nom du paquet. Si plusieurs et difficile de choisir à partir de la description, utiliser le wiki ! 😀 💡 <code>thread</code> = nombre de coeurs. Utile pour certains logiciel dont le paramétrage nécessite une valeur pour thread et nom pas un nombre de coeur<br>
💡 Pour voir la liste des variables environnement —-&gt; <a href="https://docs.hpc.shef.ac.uk/en/latest/referenceinfo/scheduler/SLURM/SLURM-environment-variables.html#gsc.tab=0">Slurm</a></p>
</section>
<section id="excécution-des-tâches" class="level4">
<h4 class="anchored" data-anchor-id="excécution-des-tâches"><u>Excécution des tâches</u></h4>
<p>Ressources utilisées dépendent su type de tâche</p>
<ul>
<li>séquencielle - un seul coeur, sur un seul noeud - tâches qui s’excecutent les unes après les autres</li>
<li>en parallèle qui utilise plusieurs coeurs potentiellement sur plusieurs noeuds - il en existe de deux types: de <strong>données</strong> et de <strong>tâches</strong>. <strong>Parall. de données</strong> est par ex, des tâches séquentielles sur plusieurs jeux de données en même temps. <strong>Parall. de tâches</strong> est par ex. un logiciel qui est capable d’effectuer plusieurs tâches en parall. sur un même jeux de données (assez rare dans certains domaines conne les sciences de la vie, mais souvent retrouvé en astro-physique par ex).</li>
<li><strong>ordonnanceur</strong> - <a href="https://slurm.schedmd.com/"><code>slurm</code></a> dispatche toutes les tâches dans les noeuds de calcul - cf liste de <a href="https://slurm.schedmd.com/man_index.html">commandes de slurm</a><br>
<img src="https://slurm.schedmd.com/slurm_logo.png" class="img-fluid"></li>
</ul>
<p>💡 utiliser <code>seff &lt;jobID&gt;</code> pour voir si la demande de ressource est optimale. Car si non optimisé, crédit au profil et les tâches vont partir moins rapidement. Cependant, reset aux deux - trois semaines. Les prioritées sont indépendantes d’une grappe à l’autre, càd entre Beluga, Narval, … <code>sshare</code> et <code>htop</code> pour voir l’état de priorité quand la tâche est lancée.</p>
<ul>
<li>toutes les grappes ont des limites de ressources. Par ex. pour 🐬<a href="https://docs.alliancecan.ca/wiki/Narval/en">Narval</a></li>
</ul>
<p>💡 GPU carte pour accélérer et nécessaire que pour certains logiciels (dans l’IA par ex), pas nécessaire pour R qui peut utiliser simplement des CPU</p>
</section>
<section id="soumission-des-tâches" class="level4">
<h4 class="anchored" data-anchor-id="soumission-des-tâches"><u>Soumission des tâches</u></h4>
<p>La soumission est faite sous la forme d’un fichier bash.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash  #ligne obligatoire</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --nodes=1 [1]</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=1 [1]</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --mem-per-cpu=1G [256M]</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --time=3:00:00 [1:00:00]</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --account=def-&lt;sponsor&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> script</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Entre crochet = valeur par défaut</p>
<p>Aller voir <a href="https://docs.alliancecan.ca/wiki/Running_jobs"><strong>Running_jobs</strong></a> dans le wiki</p>
<p>cf diapo 57 de la présentation</p>
<p><img src="sbash_file.png" width="70%"></p>
</section>
<section id="suivi-des-tâches" class="level4">
<h4 class="anchored" data-anchor-id="suivi-des-tâches"><u>Suivi des tâches</u></h4>
<p><code>srun --jobid xxxx --pty htop -u $USER</code> pour avoir accès au CPU en direct pendant que la tâche est en cours<br>
Possible aussi d’utiliser le portail, pour 🐬<a href="https://portail.narval.calculquebec.ca/">Narval</a></p>
<p>💡 Prévoir un peu de ressources en plus pour le temps et la mémoire.<br>
💡 Commandes utiles - cf diapo 59 (<code>sbatch</code>, <code>squeue</code>, <code>scancel</code>, <code>seff</code>, <code>sacct</code>)</p>
</section>
<section id="outils-intéressants-pour-les-tâches-en-parallèle" class="level4">
<h4 class="anchored" data-anchor-id="outils-intéressants-pour-les-tâches-en-parallèle">Outils intéressants pour les tâches en parallèle</h4>
<ul>
<li><a href="https://docs.alliancecan.ca/wiki/GLOST">GLOST</a></li>
<li><a href="https://docs.alliancecan.ca/wiki/META-Farm">META-FARM</a> qui peut aider pour gérer les tâches qui ont échoué (les relancer par exemple)</li>
<li>Charles conseille de préférer <a href="https://docs.alliancecan.ca/wiki/GNU_Parallel">GNU parallel</a> !</li>
</ul>
</section>
<section id="espaces-de-stockage-disponible" class="level4">
<h4 class="anchored" data-anchor-id="espaces-de-stockage-disponible"><u>Espaces de stockage disponible</u></h4>
<p>cf diapo 69</p>
</section>
</section>
</section>
<section id="mercredi-22-mai-2024" class="level2">
<h2 class="anchored" data-anchor-id="mercredi-22-mai-2024">Mercredi 22 mai 2024</h2>
<section id="formation-1---caroline-baril---introduction-à-la-gestion-de-données-de-recherche-gdr" class="level3">
<h3 class="anchored" data-anchor-id="formation-1---caroline-baril---introduction-à-la-gestion-de-données-de-recherche-gdr">Formation 1 - Caroline Baril - Introduction à la gestion de données de recherche (GDR)</h3>
<p>Responsable de la mise en place d’un programme de gestion de données<br>
Données de recherche extra variées avec des volumes pouvant être très important. Multiplicité des formats de fichiers pour un type de données, ce qui représente un vrai challenge.</p>
<section id="cycle-de-vie-des-données" class="level4">
<h4 class="anchored" data-anchor-id="cycle-de-vie-des-données">Cycle de vie des données</h4>
<p><img src="https://science-ouverte.univ-artois.fr/wp-content/uploads/2022/06/cycle.png" width="50%"></p>
<p>cf diapo 5<br>
Pour chaque étape, défi de stockage et archivage. Il existe plusieurs <u>phases actives</u> dans ce cycle de vie</p>
</section>
<section id="principe-fair" class="level4">
<h4 class="anchored" data-anchor-id="principe-fair">Principe FAIR</h4>
<p><img src="https://grapheast.hypotheses.org/files/2021/12/FAIR-data-500x299.png" class="img-fluid"></p>
<p>Les avantages d’une bonne gestion = favorise une recherche efficace et reproductible(!), réduit le coût de la recherche en temps et en argent (évite la redondance), favorise visibilité et impacte de la recherche et facilite science ouverte et transparente.</p>
</section>
<section id="gdr-en-pratique" class="level4">
<h4 class="anchored" data-anchor-id="gdr-en-pratique">GDR en pratique</h4>
<p><img src="GDR_pratiques.png" width="100%"></p>
</section>
</section>
<section id="formation-2---lina-harper---nettoyage-des-données-avec-openrefine" class="level3">
<h3 class="anchored" data-anchor-id="formation-2---lina-harper---nettoyage-des-données-avec-openrefine">Formation 2 - Lina Harper - Nettoyage des données avec OpenRefine</h3>
<p><a href="https://openrefine.org"><img src="https://openrefine.org/img/openrefine_logo.svg" width="15%"></a> Voir également la formation de <a href="https://librarycarpentry.org/lc-open-refine/01-introduction.html">Software Carpentry</a></p>
<p><img src="nettoyage_donnees.png" width="100%"></p>
<p>OpenRefine est un outil open-source, gratuit, ouvert avec UI simple et intuitif. Il supporte nombreux type de fichiers, traitement des doublons, réconciliation de plusieurs jeux de données, … et enrichissement des données via des requêtes à des APIs. Le langage de prog utilisé est GREL.</p>
<section id="pratique" class="level4">
<h4 class="anchored" data-anchor-id="pratique">Pratique</h4>
<p>Accès à openRefine via JupiterLab. Aller sur l’onglet software, chercher OpenRefine et le loader. Si il n’est pas présent, loader StdEnv 2020 d’Abord.</p>
<p>Source des données: <a href="https://donnees.montreal.ca/dataset/declarations-exterminations-punaises-de-lit">Montréal données ouvertes</a></p>
</section>
</section>
</section>
<section id="jeudi-23-mai-2024" class="level2">
<h2 class="anchored" data-anchor-id="jeudi-23-mai-2024">Jeudi 23 mai 2024</h2>
<p><u>Pour les ressources, voir <a href="https://github.com/ccoulombe/cq-intro-python">intro Python</a> &amp; <a href="https://github.com/calculquebec/analyse-donnees-python">analyse et visualisation Python</a></u></p>
<section id="formation-1---charles---introduction-à-python" class="level3">
<h3 class="anchored" data-anchor-id="formation-1---charles---introduction-à-python">Formation 1 - Charles - Introduction à Python</h3>
<p><u>GLOBALEMENT, FAIRE TRÈS ATTENTION AUX SUBTILITÉS SUR L’INDENTATIONS</u></p>
<ul>
<li>présentation de Jupyter lab</li>
<li>python langage haut niveau - code qui est interprété sans avoir besoin de le compiler - de ce fait interaction facile et rapide</li>
<li>formation basée sur contenu de <a href="http://swcarpentry.github.io/python-novice-inflammation">software carpentry</a></li>
<li>langage très utilisé dans la science des données, dev web, framework web, intelligence artificielle</li>
</ul>
<section id="jupyter-notebook" class="level4">
<h4 class="anchored" data-anchor-id="jupyter-notebook">Jupyter notebook</h4>
<p>Un notebook présente un noyau (python ici) qui permet de faire des calculs dans le document créer (existe aussi avec R)<br>
Page web avec texte, code, …. comme rmarkdown mais avec extension <code>ipynb</code><br>
Pour excécuter une section de code <code>shift + enter</code> et doit conserver l’ordre logique.<br>
Eviter d’utiliser ChatGPT et Copilot quand on débute dans le langage. Utiliser à l’inverse, vérifier des sections de codes qu’on a déjà écrit.<br>
💡💡💡 <code>%whos</code> = mot magique, liste toutes les variables existantes (<code>%</code> préfixe pour certains mot magique)<br>
💡 Quand erreur de syntaxe, <code>^</code> pointe sous l’erreur, décalé de un caractère vers la droite. 💡 Utiliser <code>TAB</code> pour complétion de variables déjà définies</p>
</section>
<section id="fondamentaux---type-de-données" class="level4">
<h4 class="anchored" data-anchor-id="fondamentaux---type-de-données">Fondamentaux - Type de données</h4>
<p>Certains type de données sont immutables. <code>List</code>, <code>set</code>, <code>dictionnary</code> sont modifiables. Pour créer des <code>strings</code>, possible d’utiliser <code>''</code> ou <code>""</code>. Au choix, mais rester persistant.<br>
💡 pour concaténer, pas besoin de l’équivalent de function <code>paste</code></p>
<p><strong>Fonction</strong> = bloc de code regroupé sous un nom et qui s’excécute lorsque ce nom est appelé</p>
<pre><code>Key points

  - Basic data types in Python include integers, strings, and floating-point numbers.
  - Use variable = value to assign a value to a variable in order to record it in memory.
  - Variables are created on demand whenever a value is assigned to them.
  - Use print(something) to display the value of something.
  - Built-in functions are always available to use.</code></pre>
</section>
<section id="numpy" class="level4">
<h4 class="anchored" data-anchor-id="numpy">Numpy</h4>
<p>= <a href="https://numpy.org/doc/stable/reference/index.html">librairie</a> pour manipuler matrices et tableaux<br>
Pour travailler avec des dataframes, utiliser la librairie <a href="https://pandas.pydata.org/">🐼 pandas</a></p>
<p>💡 <code>help()</code> pour avoir l’aide et les informations sur une fonction<br>
💡 <code>shift + tab</code> pour activer l’intellisense sur une fonction<br>
💡 <code>data[:, 3]</code> sélectionne toutes les lignes <code>:</code> de la troisième colonne<br>
💡 <code>ndarray</code> est pour <i>n dimension array</i><br>
💥💡💥 Lors de slicing (sélection d’une suite de valeurs), selection <strong>open ended</strong> <code>[from: to[</code><br>
💥💡💥 L’indexation commence à <strong>0</strong><br>
💡 <code>small = data[:3, 36:]</code> ici sélection des lignes de 0 à 2 et les colonnes de 36 à la fin.</p>
<p>Pour charger un jeux de données</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> numpy.loadtxt(fname<span class="op">=</span><span class="st">'data/inflammation-01.csv'</span>, delimiter<span class="op">=</span><span class="st">','</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Les librairies peuvent être chargées avec des <code>alias</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>data.dtype</code> permet de savoir le type des objets contenu dans la matrice <code>data</code>.<br>
<code>data.shape</code> donne la dimension de la matrice <code>data</code>.</p>
<p>Dans la fonction <code>numpy.mean()</code>, l’argument <code>axis = 1 ou 0</code> permet d’appliquer la moyenne par colonne <code>0</code> ou par ligne <code>1</code>.</p>
<p>Pour travailler sur certaines colonnes ou lignes qui ne suivent pas, il est nécessaire de créer une <code>vue</code>, puis de travailler à partir de celle-ci.</p>
<pre><code>Key points

    - Import a library into a program using import libraryname.
    - Use the numpy library to work with arrays in Python.
    - The expression array.shape gives the shape of an array.
    - Use array[x, y] to select a single element from a 2D numpy array.
    - Array indices start at 0, not 1.
    - Use low:high to specify a slice that includes the indices from low to high-1.
    - Use `# some kind of explanation to add comments to programs.
    - Use numpy.mean(array), numpy.max(array), and numpy.min(array) to calculate simple statistics.
    - Use numpy.mean(array, axis=0) or numpy.mean(array, axis=1) to calculate statistics across the specified axis.</code></pre>
</section>
<section id="matplotlib" class="level4">
<h4 class="anchored" data-anchor-id="matplotlib">Matplotlib</h4>
<p>= <a href="https://matplotlib.org/">📈 librairie</a> pour visualiser des données tabulaires</p>
</section>
<section id="les-listes" class="level4">
<h4 class="anchored" data-anchor-id="les-listes">Les listes</h4>
<p>💡 indexation négative pour accéder au(x) dernier(s) élément(s)<br>
💡 indexation possible avec step <code>list[from:to:step]</code><br>
💡 pour lister en reverse, il est indispensable d’indiquer la <code>step -1</code> pour que la lecture aille vers la gauche et non pas vers la droite.<br>
💥💡💥 Possible d’aller indexer une ou plusieurs lettres dans un string, mais cette indexation ne fonctionne pas si on veut modifier une de ces lettres.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>name<span class="op">=</span><span class="st">"Darwin"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>name[<span class="dv">2</span>] <span class="co"># r</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>name[<span class="dv">2</span>]<span class="op">=</span><span class="st">"R"</span> <span class="co"># ERROR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>💥💡💥 ATTENTION !!!!! Les copys d’éléments ne se font pas aussi simplement que dans R. Si <code>list = list2</code>, les deux sont NON-INDÉPENDANTES. SI modification sur l’une, sera appliquée également sur l’autre. Pour faire ceci, utiliser <code>list2 = list.copy()</code> ou <code>list2 = list(list)</code>. T_T</p>
<pre><code>Key Points

    - [value1, value2, value3, ...] creates a list.
    - Lists can contain any Python object, including lists (i.e., list of lists).
    - Lists are indexed and sliced with square brackets (e.g., list[0] and list[2:9]), in the same way as strings and arrays.
    - Lists are mutable (i.e., their values can be changed in place).
    - Strings are immutable (i.e., the characters in them cannot be changed).</code></pre>
</section>
<section id="repeating-actions-with-loops---for-loop" class="level4">
<h4 class="anchored" data-anchor-id="repeating-actions-with-loops---for-loop">Repeating actions with loops - <code>for</code> loop</h4>
<p><code>:</code> permet de terminer la déclaration de la ligne d’instruction de la bouble. Est suivi par le corps de la boucle qui doit être <code>indenté</code>.</p>
<p>💥💡💥 <code>range(from, to_non_inclut, step)</code> est un générateur qui ne va pas inscrire les valeurs dans la mémoire. Ceci permet l’optimisation quand utilisation de large séquence. Pour enregistrer dans une variable, nécessaire de faire <code>r = list(range(1, 6))</code> par exemple.</p>
<pre><code>Key Points

    - Use for variable in sequence to process the elements of a sequence one at a time.
    - The body of a for loop must be indented.
    - Use len(thing) to determine the length of something that contains other values.
</code></pre>
</section>
<section id="making-choice---if-loop" class="level4">
<h4 class="anchored" data-anchor-id="making-choice---if-loop">Making choice - <code>if</code> loop</h4>
<ul>
<li><a href="https://docs.python.org/3/library/stdtypes.html#truth-value-testing">documentation</a></li>
<li>par défaut, tout variable vide sera considérée comme <code>false</code> en terme booléen</li>
<li>subtilité avec <code>None</code> (qui n’est pas équivalent à <code>null</code>) dans une boucle. <code>None</code> est de classe <code>noneType</code> et ne peut être comparé avec d’autres type d’objet.</li>
<li>Bonne pratique de code = mettre en première la condition que serait la plus souvent remplie. Optimisation !</li>
</ul>
<pre><code>
Key Points

    - Use if condition to start a conditional statement, elif condition to provide additional tests, and else to provide a default.
    - The bodies of the branches of conditional statements must be indented.
    - Use == to test for equality.
    - X and Y is only true if both X and Y are true.
    - X or Y is true if either X or Y, or both, are true.
    - Zero, the empty string, and the empty list are considered false; all other numbers, strings, and lists are considered true.
    - True and False represent truth values.
</code></pre>
</section>
<section id="creating-functions" class="level4">
<h4 class="anchored" data-anchor-id="creating-functions">Creating functions</h4>
<p>🗝️ Functions let us reuse pieces of code frequently used with different parameters.<br>
🗝️ Par défaut, ttes fonctions retournent <code>Ǹone</code>, d’où l’importance d’utiliser <code>return</code> dans le corps de la fonction.</p>
<p><img src="https://miro.medium.com/v2/resize:fit:588/0*EVQvdvogpbKtsurb.png"></p>
<p>💥💡💥 We need to verify that our functions are behaving correctly. In order to do so, we can run each function and print out the boolean result of an equality test. We can also <code>assert</code> that our function behave correctly by using an assertion statement. An assertion will pass when the statement is True, otherwise will raise an exception and the code or function will not be allowed to continue. This is very useful in preventing bugs and ensuring correctness.<br>
💡 Utiliser la doc string pour ecrire l’aide de la function</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fahr_to_celsius(temp):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Converts Fahrenheit to Celcius.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">        temp: Temperature in Fahr.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">        fahr_to_celsius(32) =&gt; 0.0</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this is a comment</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ((temp <span class="op">-</span> <span class="dv">32</span>) <span class="op">*</span> (<span class="dv">5</span><span class="op">/</span><span class="dv">9</span>))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">help</span>(fahr_to_celsius)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Exemple de fonction</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> wrap(str1<span class="op">=</span><span class="st">""</span>, str2<span class="op">=</span><span class="st">"*"</span>):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">isinstance</span>(str1, <span class="bu">str</span>) <span class="op">&amp;</span> <span class="bu">isinstance</span>(str2, <span class="bu">str</span>)):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(str2, str1, str2, sep <span class="op">=</span> <span class="st">""</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">type</span>(str1) <span class="kw">is</span> <span class="kw">not</span> <span class="bu">str</span>:</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Please enter a string as first argument"</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Please enter a string as second argument"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>wrap(<span class="st">"value"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>wrap()</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>wrap(<span class="st">"value"</span>, <span class="st">"+"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>wrap(<span class="dv">3</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>wrap(<span class="st">"l"</span>, <span class="dv">4</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># *value*</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># **</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># +value+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Please enter a string as first argument</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Please enter a string as second argument</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="dictionnaire" class="level4">
<h4 class="anchored" data-anchor-id="dictionnaire">Dictionnaire</h4>
<p>Association clé valeur !<br>
La clé doit UNIQUE, sinon on écrase le contenu précédent. Pour visualisation plus sympa des gros dictionnaire</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pprint <span class="im">import</span> pprint</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pprint(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>pprint</code> is for pretty print - mais fonctionnel à partir d’une certaine quantité d’information dans le dictionnaire (fonctionne aussi avec d’autres types d’objets)</p>
<p>Pour visualiser la liste des clés-valeurs dans le dictionnaire, possible d’utiliser le code suivant (utilisé fréquemment):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, v <span class="kw">in</span> d.items():</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(k, v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="data-treatment" class="level4">
<h4 class="anchored" data-anchor-id="data-treatment">Data treatment</h4>
<ul>
<li><code>variable.rstrip()</code> remove les caractères dit blanc (espace, saut de ligne, ….)</li>
<li><code>enumerate()</code> donne les indices des valeurs dans une liste</li>
</ul>
<p><u>cf exercice de tirage de nom aléatoire avec retrait</u><br>
💡possible aussi d’utiliser <code>.remove()</code> pour faire la sans remise<br>
💡exemple possible car pas une copie de la liste nom dans la fonction, mais bien un pointeur vers le jeux de donnée, ce qui permet de faire sa modification à chaque tirage.</p>
</section>
<section id="environnement-virtuel-sur-les-grappes-de-calculs-lors-des-envois-de-tâches" class="level4">
<h4 class="anchored" data-anchor-id="environnement-virtuel-sur-les-grappes-de-calculs-lors-des-envois-de-tâches">Environnement virtuel sur les grappes de calculs lors des envois de tâches</h4>
<p>Jupiter Lab est idéal pour travailler avec les notebook python (qui sont récupérables en local).<br>
cf <a href="https://docs.alliancecan.ca/wiki/Python">documentation wiki</a></p>
</section>
</section>
</section>
<section id="vendredi-24-mai-2024" class="level2">
<h2 class="anchored" data-anchor-id="vendredi-24-mai-2024">Vendredi 24 mai 2024</h2>
<section id="analyses-et-visualisation---pier-luc-st-onge-analyste" class="level3">
<h3 class="anchored" data-anchor-id="analyses-et-visualisation---pier-luc-st-onge-analyste">Analyses et Visualisation - Pier-Luc St-Onge (analyste)</h3>
<ul>
<li>charger, modif et sauvegarder données tabulaires</li>
<li>utilisation dataframe de <code>pandas</code></li>
<li>grouper des données pour faire des stats</li>
<li>sélectionner osus-ensemble</li>
<li>combiner données tabulaires</li>
<li>visualiser avec <code>altair</code> (graphiques interactifs)</li>
</ul>
<p>Formation basée sur <a href="https://datacarpentry.org/python-ecology-lesson/">software Carpentry</a><br>
Contenu <a href="https://jupyter.a-ecole.calculquebec.cloud/user/claire/lab/tree/analyse-donnees-python/00-a_propos.ipynb">notebook IPython</a></p>
<p>Pour les données tabulaires, la librairie la plus courante est <code>pandas</code> (alias <code>pd</code>). Cette librairie permet la manip des données et fonctionne très bien avec d’autres librairies de visualisation.</p>
<p>À vérifier mais <code>pandas</code> utilise <code>NaN</code> plutôt que <code>NA</code>.<br>
<code>data.function()</code> = méthode qui correspo0nd à une fonction qui doit calculer quelque chose sur la data (ex. <code>.head()</code>, <code>.describe()</code>)<br>
Différent de <code>data.attribut</code> qui est une fonction qui extrait une information à la data (par ex. <code>.shape</code>, <code>.columns</code>)<br>
<code>count</code> dans <code>data['nomColonne'].describe()</code> sur une colonne ne prend pas en compte les valeurs nulles.<br>
Les méthodes et attributs utilisés ici sont associés à <code>pandas</code>.<br>
<code>data[nomColonne].value_counts()</code> nombre d’occurrences par valeurs<br>
<code>data.loc[ligne, colonne]</code> pour sélectionner des rangées et colonnes d’un dataframe (attribut <code>.loc</code>), existe aussi <code>iloc</code> mais se comporte différemment avec l’indexation<br>
Indice <code>-1</code> ne fonctionne pas avec <code>pandas</code><br>
Pour sélection par critères, il existe <code>isin()</code> pour aller chercher les enregistrements dont les valeurs d’une colonne correspondent à l’une des valeurs fournies dans une liste<br>
Méthode <code>.dropna()</code> permet de virer toutes lignes qui contient au moins une donnée manquante<br>
<code>data.isnull().sum()</code> va sommer tous les ‘NaN’ pour chaque colonne. Permet de données un aperçu du contenu du jeu de données</p>
<section id="visualisation" class="level4">
<h4 class="anchored" data-anchor-id="visualisation">Visualisation</h4>
<p><u>Pourquoi altair? Pourquoi pas matplotlib?</u></p>
<p>Bien que matplotlib soit une bibliothèque de visualisation largement répandue et relativement flexible, la programmation des graphiques ne suit pas une grammaire spécifique.</p>
<p>Ainsi, pour ce chapitre, nous avons fait le choix de vous présenter la bibliothèque altair qui facilite la création de graphiques hautement informatifs tout en s’intégrant bien avec Pandas. Le fonctionnement de altair se base sur la grammaire des graphiques interactifs de Vega-Lite, ce qui rend la programmation à la fois élégante et puissante.</p>
<p>Nous verrons différents concepts de visualisation qui peuvent être reproduits plus ou moins facilement avec d’autres bibliothèques telles que <code>matplotlib</code>, <code>plotnine</code> (utilise grammaire de ggplot2) dans R, <code>plotly</code> et <code>seaborn</code>.</p>
<p>💡 Possible d’utiliser <code>plotly</code> pour graphique interactif, juste plus compliqué à installer sur le notebook.<br>
💡Voir exemple <a href="https://altair-viz.github.io/"><code>altair</code></a><br>
💀 Attention ! Par défaut, <code>altair</code> a une gamme de couleur limitée à 10. Si plus de valeur à colorer, la palette devient redondante.<br>
💡 Palette de couleurs dans <a href="https://vega.github.io/vega/docs/schemes/">altair</a><br>
💡 <code>altair</code> a une technique spéciale appelée création de facettes permettant de diviser un graphique en plusieurs sous-graphiques selon les valeurs d’une variable.</p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>